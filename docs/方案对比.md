# 方案对比：原手册 vs 方案 A vs 方案 B vs 方案 C

> 本文档面向讲师/助教，说明新方案与原手册的关系和差异，方便向其他老师讲解。

---

## 一、四套方案定位

| | 原手册 | 方案 A（传统教学版） | 方案 B（Serverless 版） | 方案 C（极简静态版） |
|--|--------|---------------------|------------------------|---------------------|
| **一句话定位** | 从零手搭全流程 | 精简的原手册，保留核心原理 | 跳过运维，专注代码和部署 | 零成本极速上线 |
| **面向场景** | 课堂教学 | 课堂教学（改进版） | 课后自用 / 快速上线 | 纯静态博客体验 |
| **教学理念** | 全链路手动操作 | 去冗余，补原理，加业务关联 | 理解现代部署流程 | 最小可行产品 |
| **功能完整度** | Flask + Hugo（无关联） | 博客 + 留言板 + 统计 | 同方案 A | **仅博客** |
| **成本** | 域名 + 服务器 | 服务器（域名免费） | 免费/低成本 | **完全免费** |
| **难度** | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐ | ⭐ |

---

## 二、环节对比

### 2.1 环境搭建阶段

| 环节 | 原手册 | 方案 A | 方案 B |
|------|--------|--------|--------|
| Python/Pip 安装 | 大篇幅图文（Windows） | 前置条件，不占课时 | 同左 |
| VS Code 安装 + 插件 | 大篇幅图文 | 前置条件 | 同左 |
| Git 安装 | 大篇幅图文 | 前置条件 | 同左 |
| Hugo 安装 | Windows 手动配 PATH | 脚本自动安装 | 本地安装即可 |

**方案 A/B 的改进：** 环境安装是"工具使用"而非"Web 原理"，不应占课堂时间。改为课前预装或一键脚本。

### 2.2 Flask 开发阶段

| 环节 | 原手册 | 方案 A | 方案 B |
|------|--------|--------|--------|
| Flask 教学内容 | 路由、模板、渲染、继承 | 相同 + 实际业务 API | 代码同方案 A |
| Flask 功能 | Hello World + 作业 | 留言板 API + 访客统计 API | 同方案 A |
| 与 Hugo 关系 | **无关联**（各跑各的） | **有关联**（Hugo 调用 Flask API） | 同方案 A |
| 数据存储 | 无 | SQLite（WAL 模式） | 同方案 A |
| 调试模式 | `debug=True` 上公网 | 环境变量控制，默认关闭 | 同方案 A |

**核心改进：** 原手册的 Flask 和 Hugo 是"缝合"关系——Flask 只是练手道具，Hugo 是独立的博客，两者没有业务关联。方案 A/B 让 Flask 成为 Hugo 的后端（提供留言和统计 API），学生能理解"前后端分离"的真实架构。

### 2.3 域名和 DNS 阶段

| 环节 | 原手册 | 方案 A | 方案 B |
|------|--------|--------|--------|
| 域名获取 | NameSilo 购买（~$3） | nip.io 免费自动解析 | 平台分配子域名 |
| 花费 | 20-30 元人民币 | 0 元 | 0 元 |
| DNS 配置 | 手动配 A 记录 | 无需配置 | 无需配置 |
| DNS 缓存清理 | 大篇幅教学 | 不涉及 | 不涉及 |
| 等待 DNS 生效 | 10+ 分钟 | 无等待 | 无等待 |
| 最终域名样式 | `www.xxx.cc` | `<IP>.nip.io` | `xxx.zeabur.app` |

**方案 A 的取舍：** 用 nip.io 省掉了域名购买、DNS 配置、缓存清理这三个环节（合计占原手册约 15 页）。这些环节的知识点（DNS 解析原理）可以口头讲解，不需要每个学生实操。想要自己域名的学生可自行购买后替换。

### 2.4 服务器部署阶段

| 环节 | 原手册 | 方案 A | 方案 B |
|------|--------|--------|--------|
| 服务器 | 阿里云 ECS | 同原手册 | **不需要服务器** |
| 代码上传 | Git clone / SCP / 拖拽 | Git clone | Git push 自动部署 |
| Flask 运行方式 | Tmux 挂后台 | **Systemd 服务** | 平台自动管理 |
| 运行用户 | root（安全隐患） | **专用用户 qhfz** | 平台隔离 |
| 服务器重启后 | 服务丢失，需手动恢复 | **自动恢复**（Systemd） | 平台自动保活 |
| Nginx 配置 | 手写配置文件 | 脚本自动生成 | **不需要 Nginx** |
| WSGI 服务器 | 无（Flask 开发服务器） | **Gunicorn**（单 worker） | 平台自带 |

**方案 A 的改进：**
- Tmux → Systemd：生产环境的正确做法，重启不丢服务
- root → 专用用户：修复安全隐患
- 一键部署脚本：`./scripts/deploy-linux.sh` 自动完成全部配置

**方案 B 的省略：** 整个服务器运维层不存在。代码推到 Git，平台自动构建、部署、分配域名。

### 2.5 HTTPS 证书阶段

| 环节 | 原手册 | 方案 A | 方案 B |
|------|--------|--------|--------|
| 证书工具 | Certbot | Certbot | **平台自动提供** |
| 验证方式 | DNS TXT 验证 | HTTP-01 验证 | 不涉及 |
| 等待时间 | 10+ 分钟（等 DNS 生效） | 即时（但 nip.io 有 rate limit） | 无等待 |
| 证书续期 | 手动 | 自动（Certbot timer） | 自动 |

**方案 A 的风险提示：** nip.io 是共享域名，Let's Encrypt 对同一注册域有频率限制（每周 50 张）。如果多个学生同时申请，可能触发限制。建议课堂上跳过 HTTPS，口头讲解原理；需要 HTTPS 的学生自行购买域名。

### 2.6 Hugo 博客阶段

| 环节 | 原手册 | 方案 A | 方案 B |
|------|--------|--------|--------|
| 主题 | ananke（第三方） | 自定义浅色主题（内置） | 同方案 A |
| 主题安装 | git submodule / 手动下载 | **无需安装**，clone 即用 | 同方案 A |
| 博客内容 | 3 篇示例文章 | 同原手册 | 同原手册 |
| 与 Flask 关联 | 无 | 调用 Flask 留言/统计 API | 同方案 A |
| 部署方式 | 生成 public → 上传服务器 | 脚本自动构建 + 部署 | Git push 自动构建 |

---

## 三、课堂时间对比（估算）

| 阶段 | 原手册 | 方案 A | 方案 B | 方案 C |
|------|--------|--------|--------|--------|
| 环境安装 | 课上 | 课前 | 课前 | 课前 |
| Flask 教学 | 核心课时 | 核心课时 | 核心课时 | **跳过** |
| 域名 + DNS | 课上（含等待） | 跳过 | 跳过 | 跳过 |
| 服务器部署 | 课上（手动） | 课上（一键脚本） | 课上（Git push） | **10 分钟** |
| HTTPS 证书 | 课上（含等待） | 可选/口头讲解 | 跳过 | 跳过 |
| Hugo 博客 | 课上 | 课上 | 课上 | 课上 |

**方案 A 的核心节省：** 域名购买/DNS 配置/DNS 缓存清理/HTTPS 等待这些"非编程"环节，从实操改为口头讲解或可选环节。

**方案 C 的定位：** 专为"只想快速体验建站"的场景设计，跳过所有后端内容，直接用 Cloudflare Pages 托管 Hugo 静态博客。

---

## 四、保留的教学价值

### 方案 A 保留了什么

原手册真正有教学价值的部分都保留了：

1. **Flask Web 开发** — 路由、模板、API 设计
2. **Nginx 反向代理** — 理解请求分发（`/api/*` → Flask，`/` → 静态文件）
3. **Linux 服务管理** — Systemd（比原手册的 Tmux 更正确）
4. **前后端分离架构** — Hugo 前端调用 Flask API
5. **安全意识** — 非 root 运行、生产模式、输入校验

### 方案 A 砍掉了什么

以下内容被砍掉或改为可选，因为它们不属于"Web 开发原理"：

1. Windows 环境安装图文教程（工具操作）
2. 域名购买 + 支付流程（商业操作）
3. DNS 手动配置 + 等待生效（运维操作，可口头讲解）
4. DNS 缓存清理（运维技巧）
5. HTTPS 证书申请等待（可选环节）

### 方案 B 额外教了什么

1. **Git 工作流** — 代码提交即部署
2. **CI/CD 概念** — 自动构建、自动上线
3. **现代部署思维** — "代码即基础设施"

### 方案 C 适用场景

1. **快速体验** — 10 分钟内让学生看到自己的博客上线
2. **纯内容创作** — 只关心写 Markdown，不关心后端
3. **零成本入门** — 完全免费，无需任何服务器或域名费用

---

## 五、向其他老师讲解的要点

### "你们为什么要改手册？"

> 原手册约 30% 是核心教学内容，70% 是配置操作。学生大量时间花在等 DNS 生效、装软件、Copy-Paste 配置上，没有理解原理。我们保留了核心原理教学，去掉了与编程无关的操作环节。

### "Flask 和 Hugo 有什么变化？"

> 代码层面：Flask 从 Hello World 升级为留言板 + 统计 API，Hugo 前端调用这些 API。学生能看到真实的前后端分离架构，而不是两个互不相关的项目。

### "方案 A 和原手册的区别？"

> 像是原手册的 "精装修版"。技术栈相同（Flask + Hugo + Nginx），但修复了安全问题（非 root 运行、关闭 debug）、改进了服务管理（Systemd 替代 Tmux）、增加了业务关联（Flask 为 Hugo 提供 API）、提供了一键部署脚本。

### "方案 B 是什么？"

> 给学生课后自用的。不需要服务器，Git push 自动上线，平台提供域名和 HTTPS。代码和方案 A 完全一样，差别只在部署环节。适合学生拿到一个长期可用的个人博客。

### "方案 C 是什么？"

> 极简版，完全免费。只部署 Hugo 静态博客，不包含留言板和统计功能。适合只想快速体验建站的场景，或作为课后延伸让学生用 Cloudflare Pages / GitHub Pages 托管自己的博客。
